var $website_routespace="pssg_namespace_route",$website_routespace_multiple="multiple_product_route",$website_wpjson="pssg_json_website";function onOpen(e){var t=SpreadsheetApp.getActiveSpreadsheet(),o=t.getActiveSheet(),a=o.getName();if(""===YourSheetTabName||YourSheetTabName===a){var s=o.getLastColumn();s<5&&(s=10);var r=o.getRange(1,1,1,s);r.setFontWeight("normal"),r.setFontSize(12),o.setFrozenRows(1),o.setFrozenColumns(1);var n="Your Sheet is Connected";t.toast(n,"Information",5),Logger.log(n),o.getRange("A:A").setBackground("#f3f3f3").setFontColor("#AAA"),o.getRange("B:B").setBackground("#f3f3f3").setFontColor("#AAA"),o.getRange("1:1").setBackground("#6398eb").setFontColor("#000");var g=o.getLastRow();for(g<1e3&&(g=1e3),i=2;i<=g;i++)i%2&&o.getRange(i+":"+i).setBackground("#f0f0f0")}}function doEdit(e){var t=SpreadsheetApp.getActiveSpreadsheet(),o=t.getActiveSheet(),a=o.getName();if(""===YourSheetTabName||YourSheetTabName===a){var s=e.range,r=s.getValues();if(s.getNumRows()>1||s.getNumColumns()>1){var n=0;t.toast("Wait...","Please",6);for(var g=o.getRange(1,1,1,o.getLastColumn()).getValues()[0],l={},u=0;u<r.length;u++){for(var c=0;c<r[u].length;c++){var d=s.offset(u,c).getRow();s.offset(u,c).getColumn();for(var p=o.getRange(d,1,1,o.getLastColumn()).getValues()[0],f=p[0],v={},$=0;$<g.length;$++){var _=g[$];v[_=_.replace(/ /g,"_")]=p[$]}l[f]=v}n++}n>1?(t.toast("Multiple update started..","Updating...",6),sendToserver(l,$website_routespace_multiple)):1==n&&(t.toast(n,"Notice",16),singleCellEdit(e))}else singleCellEdit(e)}}function singleCellEdit(e){var t=SpreadsheetApp.getActiveSpreadsheet(),o=t.getActiveSheet(),a=o.getActiveCell();a.getValue();var s=a.getRow(),r=a.getColumn();if(1==s||1==r||2==r){t.toast("Unable to change title row, product_id or product_type","Info",6);try{var n=e.oldValue;o.getRange(s,r).setValue(n);return}catch(g){return}}t.toast("Updating a Product data","Info",6);var l=o.getRange(s,1).getValue();o.getRange(s,2).getValue();for(var u=o.getRange(1,1,1,o.getLastColumn()).getValues()[0],c=o.getRange(s,1,1,o.getLastColumn()).getValues()[0],d={},p=0;p<u.length;p++){var f=u[p];d[f=f.replace(/ /g,"_")]=c[p]}Logger.log(d);var v=$website_wpjson+$website_routespace,$=!1;if(""==l&&3==r)$=!0,t.toast("Creating a new Product","Creating ....",5);else if(""==l)return;var _={method:"post",contentType:"application/json",redirect:"follow",payload:JSON.stringify(d)};try{var C=UrlFetchApp.fetch(v,_);C.getResponseCode()>=200&&300>C.getResponseCode()?$?t.toast("New Product Added","Information",5):t.toast("Product Update successful!","Information",5):t.toast("Error: "+C.getContentText(),"Error",10)}catch(m){t.toast(v+"\n"+m.message,"DNS Error",10)}}function sendToserver(e,t){var o=SpreadsheetApp.getActiveSpreadsheet(),a={method:"post",contentType:"application/json",redirect:"follow",payload:JSON.stringify(e)};Logger.log("started");try{var s=UrlFetchApp.fetch($website_wpjson+t,a);s.getResponseCode()>=200&&300>s.getResponseCode()?o.toast("Multiple Update Success","Response Code: "+s.getResponseCode(),5):o.toast("Error: "+s.getContentText(),"Response Code: "+s.getResponseCode(),10)}catch(r){o.toast("DNS Error: \nYou are unable to upload to a localhost server.\n"+r.message,"DNS Error",10)}}